# [Diamond II] 평면그래프와 게임 - 18941 

[문제 링크](https://www.acmicpc.net/problem/18941) 

### 성능 요약

메모리: 35384 KB, 시간: 260 ms

### 분류

자료 구조, 분리 집합, 쌍대 그래프, 오일러 지표 (χ=V-E+F), 기하학, 그래프 이론, 평면 그래프, 작은 집합에서 큰 집합으로 합치는 테크닉

### 제출 일자

2026년 2월 20일 16:23:27

### 문제 설명

<p>A젖소와 D젖소가 평면그래프 게임을 한다. 이 게임은 처음에 <em>N</em>개의 정점과 <em>M</em>개의 간선으로 이루어진 평면그래프에서 진행된다. </p>

<p>이 때 게임은 주어진 수에 따라 두 가지 행동을 <em>Q</em>번 진행한다. </p>

<ul>
	<li>
	<p><code>1 u v</code> : 정점 <em>u</em>와 정점 <em>v</em>를 잇고 있던 간선이 있다면 그 간선을 삭제한다. </p>
	</li>
	<li>
	<p><code>2 u v</code> : 정점 <em>u</em>와 정점 <em>v</em>가 같은 컴포넌트에 속해 있는지 확인한다. 두 정점이 같은 컴포넌트에 속해 있으면 A젖소, 그렇지 않으면 D젖소의 승리이다.</p>
	</li>
</ul>

<p>원래는 2번 행동마다 어떤 젖소가 이길지 알아내면 되는 거였으나... 자신이 많이 이기지 못할걸 알아버린 험악한 D젖소는 화가 났다.</p>

<p>그래서 주어지는 모든 행동에서 주어지는 수를 다음과 같은 규칙으로 (<em>u</em>, <em>v</em>)에서 (<em>u'</em>, <em>v'</em>)으로 바꿔버리려고 한다.</p>

<p>어떤 행동이 있기 전까지의 모든 2번 행동 중 A젖소가 이긴 횟수를 <em>a</em>라고 했을 때 <em>u</em><sup><em>'</em> </sup>= (<em>u </em>- 1 + <em>X</em> × <em>a</em>) mod <em>N</em> + 1이고, <em>v<sup>'</sup></em> = (<em>v </em>- 1 + <em>Y</em> × <em>a</em>) mod <em>N</em> + 1이다. (단, <em>x</em> mod <em>y</em>는 <em>x</em>를 <em>y</em>로 나눈 나머지를 의미한다.)</p>

<p>이제 D젖소는 만족했다. 2번 행동을 할 때마다 어떤 젖소가 이기게 될지 알아보자!</p>

### 입력 

 <p>첫째 줄에는 다섯 개의 양의 정수 <em>N</em>, <em>M</em>, <em>Q</em>, <em>X</em>, <em>Y</em>가 주어진다.</p>

<p>1+<em>i</em>번째 줄에는 <em>i</em>번 정점의 좌표 <em>x</em><sub><em>i</em></sub>와 <em>y<sub>i</sub></em>가 주어진다.</p>

<p><em>N</em>+1+<em>j</em>번째 줄에는 각 간선의 양 끝점 <em>a<sub>j</sub></em>, <em>b<sub>j</sub></em> 가 주어진다. 이는 <em>j</em>번째 간선이 <em>a<sub>j</sub></em>번 정점과 <em>b<sub>j</sub></em>번 정점을 양 끝점으로 갖는 선분 모양의 간선임을 의미한다.</p>

<p><em>N</em>+<em>M</em>+2번째 줄부터 <em>Q</em>개의 줄에는 각 줄마다 하게 될 행동을 의미하는 세 정수가 주어진다. 실제로는 <em>u'</em>, <em>v'</em>을 이용하여 행동을 처리해야 함에 유의하라.</p>

### 출력 

 <p>2번 행동을 할 때마다 A젖소가 이기게 된다면 A를, D젖소가 이기게 된다면 D를 한 줄에 출력한다.</p>

